<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="index.css" />
    <title>HIPPO BANK</title>
  </head>
  <body>
    <div id="main-img-wrapper">
      <img width="320px" src="Lovepik.png" alt="coding-img" />
    </div>
    <div id="main-content-wrapper">
      <div id="intro-main">
        <p>이미 모두의 은행, 히포뱅크</p>
        <p>함께 일해요.</p>
        <p id="join-us-text">Join us!</p>
        <img id="down-arrow-icon" src="down-arrow.png" alt="arrow-img" />
      </div>
      <ul id="list-item-wrapper">
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
        <li class="list-item">26주 적금</li>
        <li class="list-item">지급</li>
        <li class="list-item">HIPPO 뱅크 활용</li>
        <li class="list-item">카드 비교</li>
        <li class="list-item">내 통장 찾기</li>
        <li class="list-item">사용자 검색</li>
        <li class="list-item">대출 상품</li>
      </ul>
      <main>
        <section id="panel1-img">
          <img id="flying-santa-img" src="./santa_flying.png" alt="santa-img" />
        </section>
        <section id="video-section">
          <div id="fixed-wrapper">
            <video
              id="video"
              src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4"
              type="video/mp4"
              muted
              loop
            ></video>
            <div id="fixed-description">
              <div>혁신이 만든</div>
              <div>히포뱅크</div>
            </div>
          </div>
        </section>
        <div id="bank-beyond-wrapper">
          <div id="bank-beyond">
            <img width="315" src="./05-text.png" alt="sample-text" />
          </div>
        </div>
        <div id="white-wrapper">
          <div id="slider-container">
            <div id="slider-content-wrapper">
              <div id="slider-content">
                <img
                  src="https://picsum.photos/id/1/600/933"
                  class="slider-image"
                  alt=""
                />
                <img
                  src="https://picsum.photos/id/59/600/933"
                  class="slider-image"
                  alt=""
                />
                <img
                  src="https://picsum.photos/id/89/600/933"
                  class="slider-image"
                  alt=""
                />
              </div>
            </div>
            <div class="slider-button" id="left-button">&lt;</div>
            <div class="slider-button" id="right-button">&gt;</div>
            <div id="slider-index">1/3</div>
          </div>
        </div>
      </main>
    </div>
  </body>
  <script>
    const listStyleChangeStartY = 700;
    const listStyleChangeEndY = 1800;

    const listItems = document.querySelectorAll(".list-item");

    const panel1Img = document.getElementById("panel1-img");
    const flyingSantaImg = document.getElementById("flying-santa-img");
    const division =
      (listStyleChangeEndY - listStyleChangeStartY) / listItems.length;

    const videoPlayBack = 500;
    const videoElement = document.getElementById("video");
    const videoSection = document.getElementById("video-section");
    const fixedWrapper = document.getElementById("fixed-wrapper");
    function centerElement(elementId, video) {
      const element = document.getElementById(elementId);
      const parent = element.parentElement;

      console.log("HW : ", element);
      if (
        window.scrollY >
        parent.offsetTop -
          (document.documentElement.clientHeight - element.offsetHeight) / 2
      ) {
        element.style.position = "fixed";
        element.style.top = "50%";
        element.style.left = "50%";
        element.style.transform = "translate(-50%, -50%)";

        if (video) {
          video.currentTime =
            (window.scrollY - videoSection.offsetTop) / videoPlayBack;
        }
      } else {
        element.style.position = "relative";
        element.style.top = "initial";
        element.style.left = "initial";
        element.style.transform = "initial";
      }
    }
    videoElement.addEventListener("loadedmetadata", () => {
      document.getElementById("video-section").style.height =
        videoElement.duration * videoPlayBack + "px";
    });

    const fixedDescriptionAppearTiming = 3470;
    const fixedDescriptionEnds = 3800;
    const fixedDescription = document.getElementById("fixed-description");
    window.addEventListener("scroll", () => {
      if (document.getElementById("on")) {
        document.getElementById("on").removeAttribute("id");
      }
      if (
        window.scrollY > listStyleChangeStartY &&
        window.scrollY < listStyleChangeEndY
      ) {
        const targetIndex = Math.round(
          (window.scrollY - listStyleChangeStartY) / division
        );
        if (listItems[targetIndex]) listItems[targetIndex].id = "on";
      }

      // 현재 스크롤 값 + 화면 높이 값을 더하면 최 하단에 내가 원하는 요소가 있는 위치에 도달하게 된다.
      const scrollYBottom =
        window.scrollY + document.documentElement.clientHeight;

      if (
        scrollYBottom > panel1Img.offsetTop &&
        scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight + 100
      ) {
        const translateX =
          80 -
          (80 * 1.8 * (scrollYBottom - panel1Img.offsetTop)) /
            panel1Img.offsetHeight +
          100;
        const translateY =
          -13 -
          (13 * (scrollYBottom - panel1Img.offsetTop)) /
            panel1Img.offsetHeight +
          100;

        const rotationDegree =
          23 -
          (23 * 2 * (scrollYBottom - panel1Img.offsetTop)) /
            panel1Img.offsetHeight;
        flyingSantaImg.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`;
      }
      centerElement("fixed-wrapper", videoElement);

      if (
        window.scrollY >
        videoSection.offsetTop +
          videoSection.offsetHeight -
          (fixedWrapper.offsetHeight +
            (document.documentElement.clientHeight -
              fixedWrapper.offsetHeight) /
              2)
      ) {
        fixedWrapper.style.position = "relative";
        fixedWrapper.style.top = "initial";
        fixedWrapper.style.left = "initial";
        fixedWrapper.style.transform = `translateY(${
          videoSection.offsetHeight - fixedWrapper.offsetHeight
        }px)`;
      }

      if (
        window.scrollY > fixedDescriptionAppearTiming &&
        window.scrollY < fixedDescriptionEnds
      ) {
        fixedDescription.style.transform = `translateY(${
          fixedDescriptionEnds - window.scrollY
        }px)`;
        fixedDescription.style.opacity =
          (window.scrollY - fixedDescriptionAppearTiming) / 300;
      } else if (window.scrollY > fixedDescriptionEnds) {
        fixedDescription.style.transform = `translateY(0px)`;
        fixedDescription.style.opacity = 1;
      } else {
        fixedDescription.style.transform = `translateY(100px)`;
        fixedDescription.style.opacity = 0;
      }

      centerElement("bank-beyond");
    });

    let currentImage = 0;

    const sliderImages = document.querySelectorAll(".slider-image");

    const sliderIndex = document.getElementById("slider-index");
    const handleSliderChange = (step) => {
      currentImage += step;
      if (currentImage < 0) {
        currentImage = sliderImages.length - 1;
      } else if (currentImage >= sliderImages.length) {
        currentImage = 0;
      }

      console.log(currentImage);
      sliderContentWrapper.scrollLeft =
        currentImage * sliderImages[currentImage]?.offsetLeft;
      sliderIndex.innerText = `${currentImage + 1}/${sliderImages.length}`;
    };

    document.getElementById("left-button").addEventListener("click", () => {
      handleSliderChange(-1);
    });
    document.getElementById("right-button").addEventListener("click", () => {
      handleSliderChange(1);
    });

    const sliderContentWrapper = document.getElementById(
      "slider-content-wrapper"
    );

    sliderContentWrapper.addEventListener("scroll", (e) => {
      const imageWidth =
        document.querySelectorAll(".slider-image")[0].offsetWidth;

      currentImage = Math.round(sliderContentWrapper.scrollLeft / imageWidth);
      sliderIndex.innerText = `${currentImage + 1}/${sliderImages.length}`;
    });
  </script>
</html>
